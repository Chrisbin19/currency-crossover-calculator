(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))S(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&S(p)}).observe(document,{childList:!0,subtree:!0});function x(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function S(o){if(o.ep)return;o.ep=!0;const r=x(o);fetch(o.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{const y=document.querySelector("#display"),m=document.querySelector(".calculator-grid"),x=document.querySelector("#mode-toggle"),S=document.querySelector(".currency-selectors"),o=document.querySelector("#from-currency"),r=document.querySelector("#to-currency"),p=document.querySelector(".chart-container"),L=document.getElementById("historyChart"),u=document.querySelector(".suggestion-box"),O="56e27194b721e951d2d615b0",w="4S99D6GXOWTPAJ5V";let s="",h="",v,g=!1,T={},c=!1,b;const D=async()=>{try{const t=await(await fetch(`https://v6.exchangerate-api.com/v6/${O}/latest/USD`)).json();t.result==="success"?(T=t.conversion_rates,N()):y.innerText="API Error"}catch{y.innerText="Network Error"}},N=()=>{o.innerHTML='<option value="">Loading...</option>',r.innerHTML='<option value="">Loading...</option>';const e=Object.keys(T);o.innerHTML="",r.innerHTML="",e.forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t,o.appendChild(n);const a=document.createElement("option");a.value=t,a.textContent=t,r.appendChild(a)}),o.value="USD",r.value="INR"},$=async(e,t)=>{p.style.display="block";const n=new Date().toISOString().split("T")[0],a=new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0];try{const f=await(await fetch(`https://api.frankfurter.app/${a}..${n}?from=${e}&to=${t}`)).json(),l=Object.keys(f.rates).sort(),i=l.map(q=>f.rates[q][t]);b&&b.destroy(),b=new Chart(L,{type:"line",data:{labels:l,datasets:[{label:`${e} to ${t} Exchange Rate`,data:i,borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.2)",borderWidth:2,tension:.4,pointRadius:0}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#FFF"}}},scales:{y:{ticks:{color:"#FFF"},grid:{color:"rgba(255, 255, 255, 0.2)"}},x:{ticks:{color:"#FFF"},grid:{color:"rgba(255, 255, 255, 0.2)"}}}}})}catch(d){console.error("Chart data fetch error:",d)}},k=async e=>{u.innerText="Finding investment ideas...";try{const n=["RELIANCE.BSE","TCS.BSE","HDFCBANK.BSE","INFY.BSE","TATAMOTORS.BSE","SBIN.BSE"].map(l=>fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${l}&apikey=${w}`).then(i=>i.json())),d=(await Promise.all(n)).map(l=>{const i=l["Global Quote"];return i&&i["05. price"]?{symbol:i["01. symbol"].replace(".BSE",""),price:parseFloat(i["05. price"])}:null}).filter(Boolean);if(d.length===0){u.innerText="Could not fetch investment ideas right now. (API limit may be reached)";return}const f=d.filter(l=>l.price<e);if(f.length>0){const l=f.slice(0,3).map(i=>`${i.symbol} (₹${i.price.toFixed(2)})`).join(", ");u.innerText=`With ₹${e.toFixed(2)}, you could invest in: ${l}.`}else u.innerText="This amount could be a great start for a mutual fund!"}catch(t){console.error("Investment data fetch error:",t),u.innerText="Could not fetch investment ideas."}},E=()=>{let e;if(g){const t=parseFloat(s);if(isNaN(t)||!o.value||!r.value)return;const n=o.value,a=r.value,d=T[n],f=T[a];e=t/d*f,s=e.toFixed(2),c=!0,$(n,a),a==="INR"?k(e):u.innerText=""}else{const t=parseFloat(h),n=parseFloat(s);if(isNaN(t)||isNaN(n))return;switch(v){case"+":e=t+n;break;case"-":e=t-n;break;case"*":e=t*n;break;case"/":e=t/n;break;case"%":e=t%n;break;default:return}s=e.toString(),c=!0}v=void 0,h=""},B=e=>{g||s!==""&&(h!==""&&E(),v=e,h=s,s="")},F=()=>{s="",h="",v=void 0,c=!1,u.innerText="",p.style.display="none",b&&b.destroy()},C=()=>{if(g){const e=c?r.value:o.value;y.innerText=`${s||"0"} ${e}`}else y.innerText=s||"0"};m.addEventListener("click",e=>{if(!e.target.matches("button"))return;const t=e.target,n=t.dataset.action,a=t.innerText;if(n==="number"&&(c&&(s="",c=!1),s==="0"&&(s=""),s+=a),n==="decimal"){if(c&&(s="0",c=!1),s.includes("."))return;s+="."}n==="operator"&&(c=!1,B(a)),n==="clear"&&F(),n==="delete"&&(s=s.slice(0,-1)),n==="equals"&&(c||E()),C()}),x.addEventListener("change",e=>{g=e.target.checked,S.style.display=g?"flex":"none",F(),C()}),o.addEventListener("change",C),r.addEventListener("change",()=>{c&&E()}),D(),C()});
